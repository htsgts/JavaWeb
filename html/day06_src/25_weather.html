<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>현재 날씨</title>
    <style>
        .wrap {
            background-color: darkblue;
            width: 400px;
            height: 800px;
            margin: 100px auto;
            padding: 100px;
            border-radius: 10px;
            border-width: 25px;
            border-color: black;
        }
        
        #main, #temp, #icon {
            color: white;
            font-size: 32px;
            text-align: center;
        }

    </style>
</head>
<body>
    <div class="wrap">
        <div id="main"></div>
        <div id="temp"></div>
        <div id="icon">
            <img width="200px" id="iconimg">
        </div>
    </div>
</body>
<script>
    const API_KEY = "4c2b2b9b6d7dd2a443656a7bd1f7a991";
    var url = "http://api.openweathermap.org/data/2.5/weather?lat=0&lon=0"
              + "&appid=" + API_KEY + "&units=metric";
    console.log(url);
    const main = document.getElementById("main");
    const temp = document.getElementById("temp");
    const iconSection = document.getElementById("iconimg");

    console.log(main);

    function getWeatherInfo(position){
        var lat = position.coords.latitude;
        var lon = position.coords.longitude;
        console.log("Live in " + lat + ", " + lon);

        url = "http://api.openweathermap.org/data/2.5/weather?"
              + "lat=" + lat + "&lon=" + lon
              + "&appid=" + API_KEY + "&units=metric";

        fetch(url).then(response => response.json())
                  .then(data => {
                       // display information
                       console.log(data.weather[0].main);
                       main.innerText = data.weather[0].main;
                       temp.innerText = data.main.temp + "ºC";

                       // icon
                       icon = data.weather[0].icon;
                       console.log(icon);
                       const iconURL = "http://openweathermap.org/img/wn/" + icon + "@2x.png";
                       iconSection.setAttribute('src', iconURL);
                  });
              
    }

    navigator.geolocation.getCurrentPosition(getWeatherInfo);
</script>
</html>